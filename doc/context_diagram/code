@startuml
!theme materia
title Social Network - Context Diagram

actor User as "User"

package "Social Network System" {
  [Main Service] as main
  [Posts and Comments Service] as postcom
  [Statistics Service] as stat
}

User --> main : Authentication and Registration (REST Api)
User --> main : Create, Change, Delete posts (REST Api)
User --> main : View posts (REST Api)
User --> main : Like posts (REST Api)

database "User DB (PostgreSQL)" as userdb
database "Post DB (PostgreSQL)" as postdb 
database "Statistic DB (ClickHouse)" as statdb 

main --> postcom : gRPC 
main --> stat : gRPC 

postcom --> postdb : Reads/Writes
main --> userdb : Reads/Writes
stat --> statdb : Reads/Writes

queue "Message Broker (Kafka)" as mb

postcom --> mb : Send events(Like, View)
mb --> stat : Send events for stats update
@enduml
